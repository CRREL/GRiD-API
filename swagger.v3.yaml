---
swagger: '2.0'

################################################################################
# API Information
################################################################################
info:
  title: GRiD API v3
  description: |
    This is the API v3 specification for the Geospatial Repository and 
    Data Management System (aka GRiD). Here you can see API examples and
    interact with all of the API endpoints visually in your browser. If you would
    like to see the API in action, be sure to Authorize and then try the
    "Try it out!" button for an endpoint. Note: you will be interacting with
    live data.

    Authentication using OAuth 2.0 - Authorization Code.
  version: "3.0.0"
  contact:
    url: https://github.com/CRREL/GRiD-API/

################################################################################
# Other root-level fixed fields
################################################################################
host: {{ domain }}
schemes:
  - {{ protocol }}
securityDefinitions:
  OauthSecurity:
    type: oauth2
    authorizationUrl: {{ URL_ROOT }}api/authorize
    tokenUrl: {{ URL_ROOT }}api/token
    flow: accessCode
    scopes:
      api: grant api access
security:
  - OauthSecurity:
    - api
basePath: {{ URL_ROOT }}api/v3
consumes:
  - application/json
produces:
  - application/json
tags:
  - name: AOI
    description: AOI resources.
  - name: Export
    description: Export resources.
  - name: Product
    description: Product resources.
  - name: Geoname
    description: Lookup geoname.
  - name: Task
    description: Task resources.
  - name: Hook
    description: Hook resources.

################################################################################
# Paths
################################################################################
paths:
  /aois:
    get:
      tags:
        - AOI
      summary: Get all AOIs
      description: |
        Get a list of the AOIs created by or shared with your user.
      parameters:
        - name: geom
          in: query
          description: A WKT geometry used to filter AOI results.
          required: false
          type: string
      responses:
        200:
          description: An array of AOIs.
          schema:
            $ref: '#/definitions/AOIReturn'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    post:
      tags:
        - AOI
      summary: Create an AOI
      consumes:
        - application/json
      description: |
        Create a new AOI for the given geometry.
      parameters:
        - name: name
          in: formData
          description: The name for the AOI.
          required: true
          type: string
        - name: geom
          in: formData
          description: A WKT geometry describing the AOI.
          required: true
          type: string
        - name: notes
          in: formData
          description: The notes for the AOI.
          required: false
          type: string
        - name: subscribe
          in: formData
          description: |
            Whether or not to subscribe to the AOI. Accepted values: True, False, T, F, 1, or 0.
          default: false
          required: false
          type: boolean
      responses:
        200:
          description: An array containing the new AOI.
          schema:
            $ref: '#/definitions/AOIReturn'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /aois/{pk}:
    get:
      tags:
        - AOI
      summary: Get AOI by PK
      description: |
        Get information for one or more AOIs.
      parameters:
        - name: pk
          in: path
          description: A comma-separated list of AOI primary keys.
          required: true
          type: integer
      responses:
        200:
          description: An array of AOIs.
          schema:
            $ref: '#/definitions/AOIReturn'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    patch:
      tags:
        - AOI
      summary: Edit AOI by PK
      description: |
        Update an AOIs name, notes, or geometry. In order to change an AOI's
        geometry, it must contain 0 generated exports. While we can `GET` or `DELETE` multiple primary keys, the `PATCH` may only be applied to a single primary key.
      parameters:
        - name: pk
          in: path
          description: The primary key of an existing AOI.
          required: true
          type: integer
        - name: name
          in: formData
          description: The name for the AOI.
          required: false
          type: string
        - name: geom
          in: formData
          description: A WKT geometry describing the AOI.
          required: false
          type: string
        - name: notes
          in: formData
          description: The notes for the AOI.
          required: false
          type: string
        - name: subscribe
          in: formData
          description: Whether or not to subscribe to the AOI.
          required: false
          type: boolean
      responses:
        200:
          description: An array containing the updated AOI.
          schema:
            $ref: '#/definitions/AOIReturn'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    delete:
      tags:
        - AOI
      summary: Delete AOI by PK
      description: Delete one or more existing AOIs.
      parameters:
        - name: pk
          in: path
          description: A comma-separated list of AOI primary keys.
          required: true
          type: integer
      responses:
        200:
          description: Successful AOI deletion responds with an empty body.
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /aoi:
    get:
      deprecated: true
      tags:
        - AOI
      summary: Get a User's AOI List
      description: |
        Get a list of the AOIs created by or shared with the current GRiD user.
      parameters:
        - name: geom
          in: query
          description: A WKT geometry used to filter AOI results.
          required: false
          type: string
      responses:
        200:
          description: An array of AOIs.
          schema:
            $ref: '#/definitions/AOIReturn'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /aoi/add:
    get:
      deprecated: true
      tags:
        - AOI
      summary: Add AOI
      description: |
        Create a new AOI for the given geometry.
      parameters:
        - name: name
          in: query
          description: The name for the AOI.
          required: true
          type: string
        - name: geom
          in: query
          description: A WKT geometry describing the AOI.
          required: true
          type: string
        - name: subscribe
          in: query
          description: |
            True, False, T, F, 1, or 0. Default value is false.
          default: false
          required: false
          type: boolean
      responses:
        200:
          description: An AOI object.
          schema:
            $ref: '#/definitions/AOI'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /aoi/{pk}:
    get:
      deprecated: true
      tags:
        - AOI
      summary: AOI Detail
      description: |
        Get information for a single AOI.
      parameters:
        - name: pk
          in: path
          description: The primary key for the AOI.
          required: true
          type: integer
      responses:
        200:
          description: An AOI object.
          schema:
            $ref: '#/definitions/AOI'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /aoi/edit/{pk}:
    get:
      deprecated: true
      tags:
        - AOI
      summary: Edit AOI
      description: |
        Update an AOIs name, notes, or geometry. In order to change an AOI's
        geometry, it must contain 0 generated exports.
      parameters:
        - name: pk
          in: path
          description: The primary key of the AOI.
          required: true
          type: integer
        - name: name
          in: query
          description: The name for the AOI.
          required: false
          type: string
        - name: geom
          in: query
          description: A WKT geometry describing the AOI.
          required: false
          type: string
        - name: notes
          in: query
          description: The notes for the AOI.
          required: false
          type: string
      responses:
        200:
          description: An AOI object.
          schema:
            $ref: '#/definitions/AOI'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /aoi/delete/{pk}:
    get:
      deprecated: true
      tags:
        - AOI
      summary: Delete AOI
      description: Delete an existing AOI.
      parameters:
        - name: pk
          in: path
          description: A comma-separated list of AOI primary keys.
          required: true
          type: integer
      responses:
        200:
          description: Successful AOI deletion responds with an empty body.
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /aoi/{pk}/generate/pointcloud:
    get:
      deprecated: true
      tags:
        - AOI
      summary: Generate Pointcloud Export
      description: |
        Generate pointcloud export for the given AOI and collect primary keys.
      parameters:
        - name: pk
          in: path
          description: The primary key for the AOI.
          required: true
          type: integer
        - name: products
          in: query
          description: |
            A list of product primary keys to include in the export, separated 
            by + or ,.
          required: true
          type: string
        - name: name
          in: query
          description: An optional name for the export.
          required: false
          type: string
        - name: intensity
          in: query
          description: Whether or not to export intensity. Default is true.
          default: true
          required: false
          type: boolean
        - name: dim_classification
          in: query
          description: Whether or not to export classification. Default is true.
          default: true
          required: false
          type: boolean
        - name: hsrs
          in: query
          description: Accepts an EPSG code. Defaults to AOI SRS.
          required: false
          type: integer
        - name: file_export_options
          in: query
          description: |
            Determine file merging strategy. Accepts individual, collect, and super. 
            Default is individual.
          required: false
          type: string
        - name: file_export_format
          in: query
          description: |
            Determine the format of the output file. Valid values are las12, 
            las14, nitf, pdf, and bpf3. Default is las12.
          required: false
          type: string
        - name: compressed
          in: query
          description: |
            Whether or not to export compressed data. Default is true.
          default: true
          required: false
          type: boolean
        - name: send_email
          in: query
          description: |
            Whether or not to notify user via email upon completion. Default is 
            false.
          default: false
          required: false
          type: boolean
        - name: generate_dem
          in: query
          description: |
            Whether or not to generate a DEM from the pointcloud. Default is 
            false.
          default: false
          required: false
          type: boolean
        - name: cell_spacing
          in: query
          description: |
            Used together with generate_dem. Default is 1.0. Ignored for 
            raster types.
          required: false
          type: number
          format: float
        - name: smrf_terrain
          in: query
          description: |
            Used to trigger a SMRF Bare Earth export. Accepts default, urban or suburban, 
            mountainous, and foliated. Default is None. Cannot be used with 
            sri_hres or pmf_terrain options.
          required: false
          type: string
        - name: pmf_terrain
          in: query
          description: |
            Used to trigger a PMF Bare Earth export. Accepts urban, suburban, 
            mountainous, and foliated. Default is none. Cannot be used with 
            smrf_terrain or sri_hres options.
          required: false
          type: string
        - name: sri_hres
          in: query
          description: |
            Used to trigger a Sarnoff Bare Earth export. Accepts the horizontal 
            resolution. Default is none. Cannot be used with smrf_terrain or pmf_terrain options.
          required: false
          type: number
          format: float
        - name: decimation_radius
          in: query
          description: |
            The minimum distance between points. If a neighboring point is
            found within this radius, it will be discarded. Uses PDAL
            decimation filter. Default is none.
          required: false
          type: number
          format: float
        - name: capacity
          in: query
          description: |
            How many points to fit into each tile. The number of points in each 
            tile will not exceed this value, and will sometimes be less than 
            it. Uses PDAL chipper filter. Cannot be used with retile_area 
            option. Default is none.
          required: false
          type: integer
        - name: length
          in: query
          description: |
            The target length of generated tiles. Units determined by source 
            data. Uses PDAL splitter filter. Cannot be used with retile_size 
            option. Default is none.
          required: false
          type: number
          format: float
      responses:
        200:
          description: A generate export object.
          schema:
            $ref: '#/definitions/GenerateExport'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /aoi/{pk}/generate/raster:
    get:
      deprecated: true
      tags:
        - AOI
      summary: Generate Raster Export
      description: |
        Generate raster export for the given AOI and collect primary keys.
      parameters:
        - name: pk
          in: path
          description: The primary key for the AOI.
          required: true
          type: integer
        - name: products
          in: query
          description: |
            A list of product primary keys to include in the export, separated 
            by + or ,.
          required: true
          type: string
        - name: name
          in: query
          description: An optional name for the export.
          required: false
          type: string
        - name: hsrs
          in: query
          description: Accepts an EPSG code. Defaults to AOI SRS.
          required: false
          type: integer
        - name: file_export_options
          in: query
          description: |
            Determine file merging strategy. Accepts individual and collect. 
            Default is individual.
          required: false
          type: string
        - name: file_format_options
          in: query
          description: |
            Determine the format of the output file. Valid values are GTiff and 
            NITF. Default is GTiff.
          required: false
          type: string
        - name: compressed
          in: query
          description: |
            Whether or not to export compressed data. Default is true.
          default: true
          required: false
          type: boolean
        - name: send_email
          in: query
          description: |
            Whether or not to notify user via email upon completion. Default is 
            false.
          default: false
          required: false
          type: boolean
      responses:
        200:
          description: A generate export object.
          schema:
            $ref: '#/definitions/GenerateExport'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /exports:
    post:
      tags:
        - Export
      summary: Generate export
      consumes:
        - application/json
      description: |
        Exports is new in API v3. It replaces the former `/aoi/{pk}/generate/pointcloud` endpoint. A user would typically begin by querying `/products` for available products that are coincident with the provided geometry `geom`.
      parameters:
        - name: aoi
          in: formData
          description: The primary key of the AOI used to export from.
          required: true
          type: integer
        - name: products
          in: formData
          description: |
            A comma-separated list of product primary keys to include in the export.
          required: true
          type: string
        - name: name
          in: formData
          description: An optional name for the export.
          required: false
          type: string
        - name: hsrs
          in: formData
          description: Accepts an EPSG code. Defaults to the source data HSRS.
          required: false
          type: integer
        - name: vsrs
          in: formData
          description: Pointcloud and Raster export option. Accepts an EPSG code. Valid supported values are 4326, 5773, and 3855. Defaults to source data VSRS if present.
          required: false
          type: integer
        - name: file_export_options
          in: formData
          description: |
            Pointcloud and Raster export option. Determine file merging strategy. Accepts individual and collect. 
            Default is individual.
          required: false
          type: string
        - name: compressed
          in: formData
          description: |
            Pointcloud and Raster export option. Whether or not to export compressed data. Defaults to True.
          required: false
          type: boolean
        - name: send_email
          in: formData
          description: |
            Whether or not to notify user via email upon completion. Defaults to False.
          required: false
          type: boolean
        - name: intensity
          in: formData
          description: Pointcloud export option. Whether or not to export intensity. Defaults to True.
          required: false
          type: boolean
        - name: dim_classification
          in: formData
          description: Pointcloud export option. Whether or not to export classification. Defaults to True.
          required: false
          type: boolean
        - name: file_export_format
          in: formData
          description: |
            Pointcloud export option. Determine the format of the output file(s). Valid values are las12, 
            las14, nitf, pdf, and bpf3. Defaults to las12.
          required: false
          type: string
        - name: generate_dem
          in: formData
          description: |
            Pointcloud export option. Whether or not to generate a DEM from the pointcloud. Defauls to False.
          required: false
          type: boolean
        - name: cell_spacing
          in: formData
          description: |
            Pointcloud export option used together with generate_dem. Ignored for 
            raster types. Defaults to 1.0.
          required: false
          type: number
          format: float
        - name: smrf_terrain
          in: formData
          description: |
            Pointcloud export option. Used to trigger a SMRF Bare Earth export. Accepts default, urban or suburban,
            mountainous, and foliated. Default is None. Cannot be used with
            pmf_terrain or sri_hres options.
          required: false
          type: string
        - name: pmf_terrain
          in: formData
          description: |
            Pointcloud export option. Used to trigger a PMF Bare Earth export. Accepts urban, suburban,
            mountainous, and foliated. Default is none. Cannot be used with
            sri_hres option.
        - name: sri_hres
          in: formData
          description: |
            Pointcloud export option. Used to trigger a Sarnoff Bare Earth export. Accepts the horizontal
            resolution. Default is none. Cannot be used with smrf_terrain or pmf_terrain options.
          required: false
          type: number
          format: float
        - name: decimation_radius
          in: formData
          description: |
            Pointcloud export option. The minimum distance between points. If a neighboring point is
            found within this radius, it will be discarded. Uses PDAL
            decimation filter. Default is none.
          required: false
          type: number
          format: float
        - name: capacity
          in: formData
          description: |
            Pointcloud export option. How many points to fit into each tile. The number of points in each 
            tile will not exceed this value, and will sometimes be less than 
            it. Uses PDAL chipper filter. Cannot be used with retile_area 
            option. Default is none.
          required: false
          type: integer
        - name: length
          in: formData
          description: |
            Pointcloud export option. The target length of generated tiles. Units determined by source 
            data. Uses PDAL splitter filter. Cannot be used with retile_size 
            option. Default is none.
          required: false
          type: number
          format: float
        - name: file_format_options
          in: formData
          description: |
            Raster export option.  Determine the format of the output file(s). Valid values are GTiff and 
            NITF. Defaults to GTiff.
          required: false
          type: string
        - name: vector_format
          in: formData
          description: |
            Vector export option. Accepts officially supported vector formats. Valid values are ESRI Shapefile, GML, GPKG, LIBKML, GeoJSON, and SQLite. 
            Defaults to ESRI Shapefile.
          required: false
          type: string
      responses:
        200:
          description: Started export object.
          schema:
            $ref: '#/definitions/ExportStartedReturn'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /exports/{pk}:
    get:
      tags:
        - Export
      summary: Get export by PK
      description: Get information for one or more exports.
      parameters:
        - name: pk
          in: path
          description: A comma-separated list of export primary keys.
          required: true
          type: integer
      responses:
        200:
          description: Export objects.
          schema:
            $ref: '#/definitions/ExportReturn'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    patch:
      tags:
        - Export
      summary: Edit export by PK
      description: Updates an exports name or notes. While we can `GET` or `DELETE` multiple primary keys, the `PATCH` may only be applied to a single primary key.
      parameters:
        - name: pk
          in: path
          description: The primary key of the export.
          required: true
          type: integer
        - name: name
          in: formData
          description: The name for the export.
          required: false
          type: string
        - name: notes
          in: formData
          description: The notes for the export.
          required: false
          type: string
      responses:
        200:
          description: Export object.
          schema:
            $ref: '#/definitions/ExportReturn'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    delete:
      tags:
        - Export
      summary: Delete export by PK
      description: Delete one or more existing exports.
      parameters:
        - name: pk
          in: path
          description: A comma-separated list of export primary keys.
          required: true
          type: integer
      responses:
        200:
          description: Successful export deletion responds with an empty body.
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /export/{pk}:
    get:
      deprecated: true
      tags:
        - Export
      summary: Get export details.
      description: Get information for a single export.
      parameters:
        - name: pk
          in: path
          description: The primary key of the AOI.
          required: true
          type: integer
      responses:
        200:
          description: An export object.
          schema:
            $ref: '#/definitions/Export'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /export/edit/{pk}:
    get:
      deprecated: true
      tags:
        - Export
      summary: Edit export
      description: Updates an exports name or notes.
      parameters:
        - name: pk
          in: path
          description: The primary key of the export.
          required: true
          type: integer
        - name: name
          in: query
          description: The name for the export.
          required: false
          type: string
        - name: notes
          in: query
          description: The notes for the export.
          required: false
          type: string
      responses:
        200:
          description: An export object.
          schema:
            $ref: '#/definitions/Export'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /export/delete/{pk}:
    get:
      deprecated: true
      tags:
        - Export
      summary: Delete export
      description: Deletes an existing export.
      parameters:
        - name: pk
          in: path
          description: The primary key of the export.
          required: true
          type: integer
      responses:
        200:
          description: Successful export deletion responds with an empty body.
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /products:
    get:
      tags:
        - Product
      summary: Get products by geom
      description: |
        API users will query the `products` endpoint to discover available products that are coincident with the given geometry `geom`. 
        Results can be filtered by sensor or type.
      parameters:
        - name: geom
          in: query
          description: A WKT geometry describing the AOI.
          required: true
          type: string
        - name: sensor
          in: query
          description: Limit results to products from a particular sensor.
          required: false
          type: string
        - name: type
          in: query
          description: Limit results to products of a particular type (pointcloud, raster, vector).
          required: false
          type: string
      responses:
        200:
          description: Product objects.
          schema:
            $ref: '#/definitions/ProductReturnSimple'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /products/{pk}:
    get:
      tags:
        - Product
      summary: Get product by PK
      description: Get information for one or more products.
      parameters:
        - name: pk
          in: path
          description: A comma-separated list of product primary keys.
          required: true
          type: integer
      responses:
        200:
          description: A product (pointcloud or raster) object.
          schema:
            $ref: '#/definitions/ProductReturn'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /product/{pk}:
    get:
      deprecated: true
      tags:
        - Product
      summary: Get product details
      description: Get information for a single product (pointcloud or raster).
      parameters:
        - name: pk
          in: path
          description: The primary key of the product.
          required: true
          type: integer
      responses:
        200:
          description: A product (pointcloud or raster) object.
          schema:
            $ref: '#/definitions/Product'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /geonames:
    get:
      tags:
        - Geoname
      summary: Lookup geoname by geom
      description: |
        Get suggested AOI name based on geographic coordinates of the geometry.
      parameters:
        - name: geom
          in: query
          description: A WKT geometry describing the AOI.
          required: true
          type: string
      responses:
        200:
          description: Geoname object.
          schema:
            $ref: '#/definitions/GeonameReturn'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /geoname:
    get:
      deprecated: true
      tags:
        - Geoname
      summary: Lookup eoname
      description: |
        Get suggested AOI name based on geographic coordinates of the geometry.
      parameters:
        - name: geom
          in: query
          description: A WKT geometry describing the AOI.
          required: true
          type: string
      responses:
        200:
          description: A geoname object.
          schema:
            type: object
            properties:
              geom:
                type: string
                description: The WKT geometry describing the AOI.
              name:
                type: string
                description: The suggested name for the given geometry.
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /tasks:
    get:
      tags:
        - Task
      summary: Get all tasks
      description: Get all of your tasks. Results can be filtered by state or name.
      parameters:
        - name: state
          in: query
          description: The state of the task (SUCCESS, RUNNING, QUEUED, CANCELED, or FAILURE).
          required: false
          type: string
        - name: name
          in: query
          description: The name of the task (export.tasks.generate_export, export.tasks.entwine_export, api.tasks.deliver_hook, tda.tasks.generate_tda, export.tasks.colorize_export_pdf).
          required: false
          type: string
      responses:
        200:
          description: Task objects.
          schema:
            $ref: '#/definitions/TaskReturn'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /tasks/{task_id}:
    get:
      tags:
        - Task
      summary: Get task by task_id
      description: Get information for one or more tasks.
      parameters:
        - name: task_id
          in: path
          description: The ID of the task.
          required: true
          type: string
      responses:
        200:
          description: Task object.
          schema:
            $ref: '#/definitions/TaskReturn'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /task/{task_id}:
    get:
      deprecated: true
      tags:
        - Task
      summary: Get task details
      description: Get task status/details for the provided task_id.
      parameters:
        - name: task_id
          in: path
          description: The ID of the task.
          required: true
          type: string
      responses:
        200:
          description: A task object.
          schema:
            $ref: '#/definitions/Task'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /hooks:
    get:
      tags:
        - Hook
      summary: Get all hooks
      description: Get all of your hooks.
      responses:
        200:
          description: Hook objects.
          schema:
            $ref: '#/definitions/HookReturn'
    post:
      tags:
        - Hook
      summary: Create hook
      consumes:
        - application/json
      description: |
        Create a new hook. Hooks are new to v3 of the API and allow for users to subscribe to particular GRiD events and be notified when they occur.
        Currently supported events are: newdata.loaded and export.complete. The newdata.loaded event is triggered any time new pointcloud or raster data
        is ingested into GRiD and intersects one of your existing AOIs. The export.complete event is triggered any time one of your exports finishes, SUCCESS or FAILURE.
        The scope of these notifications can be controlled by including an optional AOI parameter. Newdata and export notifications will be limited to the given AOI if supplied.
        Hooks that fail to deliver will retry 5 times. Delivered hooks that receive a 410 or 500+ return response will be automatically deleted.
      parameters:
        - name: event
          in: formData
          description: The event being subscribed to (export.complete, newdata.loaded)
          required: true
          type: string
        - name: target
          in: formData
          description: The destination URL for payloads to be delivered to.
          required: true
          type: string
        - name: aoi
          in: formData
          description: The pk of an AOI. Used to limit the scope of event notifications.
          required: false
          type: integer
      responses:
        200:
          description: A hook object.
          schema:
            $ref: '#/definitions/HookReturn'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /hooks/{pk}:
    get:
      tags:
        - Hook
      summary: Get hook by PK
      description: Get information for one or more hooks.
      parameters:
        - name: pk
          in: path
          description: A comma-separated list of hook primary keys.
          required: true
          type: integer
      responses:
        200:
          description: A hook object.
          schema:
            $ref: '#/definitions/HookReturn'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    patch:
      tags:
        - Hook
      summary: Edit hook by PK
      description: Updates an hooks event, target, or AOI. While we can `GET` or `DELETE` multiple primary keys, the `PATCH` may only be applied to a single primary key.
      parameters:
        - name: pk
          in: path
          description: The primary key of the hook.
          required: true
          type: integer
        - name: event
          in: formData
          description: The event being subscribed to (export.complete, newdata.loaded)
          required: false
          type: string
        - name: target
          in: formData
          description: The destination URL for payloads to be delivered to.
          required: false
          type: string
        - name: aoi
          in: formData
          description: The pk of an AOI. Used to limit the scope of event notifications.
          required: false
          type: integer
      responses:
        200:
          description: Hook object.
          schema:
            $ref: '#/definitions/HookReturn'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    delete:
      tags:
        - Hook
      summary: Delete hook
      description: Delete one or more existing hooks.
      parameters:
        - name: pk
          in: path
          description: A comma-separated list of hook primary keys.
          required: true
          type: integer
      responses:
        200:
          description: Successful hook deletion responds with an empty body.
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /hooks/{pk}/test:
    post:
      tags:
        - Hook
      summary: Test a hook by PK
      description: Tests a hook by sending event-specific test data to the hooks target url.
      consumes: 
        - text/plain; charset=utf-8
      parameters:
        - name: pk
          in: path
          description: A comma-separated list of hook primary keys.
          required: true
          type: integer
      responses:
        200:
          description: Successful hook test responds with an empty body.
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
definitions:
  AOI:
    type: object
    properties:
      name:
        $ref: '#/definitions/Name'
      created_at:
        $ref: '#/definitions/CreatedAt'
      user:
        $ref: '#/definitions/User'
      geom:
        $ref: '#/definitions/Geometry'
      area:
        $ref: '#/definitions/Area'
      notes:
        $ref: '#/definitions/Notes'
      pk:
        $ref: '#/definitions/Pk'
      exports:
        type: array
        items:
          $ref: '#/definitions/Export'
      pointcloud_intersects:
        type: array
        items:
          $ref: '#/definitions/PointcloudDatasetSimple'
        description: The pointcloud products for the AOI. Includes AOI coverage.
      raster_intersects:
        type: array
        items:
          $ref: '#/definitions/RasterDatasetSimple'
        description: The raster products for the AOI. Includes AOI coverage.
      vector_intersects:
        type: array
        items:
          $ref: '#/definitions/VectorDatasetSimple'
        description: The vector products for the AOI. Includes AOI coverage.
      new_pointcloud_data:
        type: array
        items:
          $ref: '#/definitions/Pk'
        description: The list of pointcloud product PKs that have been loaded to GRiD since your last inquiry for this AOI.
      new_raster_data:
        type: array
        items:
          $ref: '#/definitions/Pk'
        description: The list of raster product PKs that have been loaded to GRiD since your last inquiry for this AOI.
      new_vector_data:
        type: array
        items:
          $ref: '#/definitions/Pk'
        description: The list of vector product PKs that have been loaded to GRiD since your last inquiry for this AOI.
      subscribed:
        type: boolean
        description: Indicates the subscription status for the AOI.
  AOICoverage:
    type: number
    format: float
    description: |
      The percent of the object area covered by the AOI.
  AOIReturn:
    type: object
    properties:
      aois:
        type: array
        items:
          $ref: '#/definitions/AOI'
        description: AOI.
  Area:
    type: number
    format: float
    description: The area of the geometry in sq_km.
  Capacity:
    type: number
    format: float
    description: The number of points used to generate each file.
  CellSpacing:
    type: number
    format: float
    description: The cell spacing used in DEM generation, if applicable.
  Classification:
    type: string
    description: The classifications selected for the export.
  CollectedAt:
    type: string
    format: date-time
    description: The date of collection. ISO 8601 format as UTC.
  CreatedAt:
    type: string
    format: date-time
    description: The date of AOI creation. ISO 8601 format as UTC.
  Datatype:
    type: string
    description: The datatype (e.g., LAS 1.2, DTM).
  DimClassification:
    type: boolean
    description: |
      Whether or not Classification dimension is included in exported data.
  Error:
    type: object
    properties:
      error:
        type: string
        description: Description of the error from the given API request.
  Export:
    type: object
    properties:
      datatype:
        $ref: '#/definitions/Datatype'
      user:
        $ref: '#/definitions/User'
      hsrs:
        $ref: '#/definitions/HSRS'
      vsrs:
        $ref: '#/definitions/VSRS'
      name:
        $ref: '#/definitions/Name'
      pk:
        $ref: '#/definitions/Pk'
      started_at:
        $ref: '#/definitions/StartedAt'
      status:
        $ref: '#/definitions/Status'
      url:
        $ref: '#/definitions/URL'
      rgb:
        $ref: '#/definitions/RGB'
      intensity:
        $ref: '#/definitions/Intensity'
      dim_classification:
        $ref: '#/definitions/DimClassification'
      file_export_options:
        $ref: '#/definitions/FileExportOptions'
      generate_dem:
        $ref: '#/definitions/GenerateDEM'
      send_email:
        $ref: '#/definitions/SendEmail'
      cell_spacing:
        $ref: '#/definitions/CellSpacing'
      notes:
        $ref: '#/definitions/Notes'
      classification:
        $ref: '#/definitions/Classification'
      pmf_terrain:
        $ref: '#/definitions/PMFTerrain'
      smrf_terrain:
        $ref: '#/definitions/SMRFTerrain'
      sri_hres:
        $ref: '#/definitions/SRIHRES'
      exportfiles:
        $ref: '#/definitions/ExportfilesReturn'
      tools:
        $ref: '#/definitions/ToolsReturn'
      task_id:
        $ref: '#/definitions/TaskID'
      capacity:
        $ref: '#/definitions/Capacity'
      length:
        $ref: '#/definitions/Length'
      file_format_options:
        $ref: '#definitions/FileFormatOptions'
      vector_format:
        $ref: '#definitions/VectorFormat'
  ExportReturn:
    type: object
    properties:
      exports:
        type: array
        items:
          $ref: '#/definitions/Export'
        description: Exports
  Exportfile:
    type: object
    properties:
      datatype:
        $ref: '#/definitions/Datatype'
      name:
        $ref: '#/definitions/Name'
      pk:
        $ref: '#/definitions/Pk'
      url:
        $ref: '#/definitions/URL'
      filesize:
        $ref: '#definitions/Filesize'
      aoi_coverage:
        $ref: '#/definitions/AOICoverage'
  ExportfilesReturn:
    type: array
    items:
      $ref: '#/definitions/Exportfile'
    description: The export files of the export.
  ExportStarted:
    type: object
    properties:
      export_id:
        $ref: '#/definitions/Pk'
      task_id:
          $ref: '#/definitions/TaskID'
  ExportStartedReturn:
    type: object
    properties:
      exports:
        type: array
        items:
          $ref: '#/definitions/ExportStarted'
        description: Export ID and task ID.
  FileExportOptions:
    type: string
    description: |
      The file export options used (individual, collect, super).
  FileFormatOptions:
    type: string
    description: The format of the output raster file(s).
  Filesize:
    type: integer
    description: The size of the product on the filesystem in bytes.
  GenerateDEM:
    type: boolean
    description: Whether or not this was a generated DEM from pointcloud.
  GenerateExport:
    type: object
    properties:
      name:
        type: integer
        description: The ID of the resulting export.
      geom:
        type: string
        description: The ID of the task.
  Geometry:
    type: string
    description: |
      The WKT geometry of the object.
  Geoname:
    type: object
    properties:
      name:
        $ref: '#/definitions/Name'
      geom:
        $ref: '#/definitions/Geometry'
  GeonameReturn:
    type: object
    properties:
      geonames:
        type: array
        items:
          $ref: '#/definitions/Geoname'
        description: A list of geonames.
  Hook:
    type: object
    properties:
      pk:
        $ref: '#/definitions/Pk'
      version:
        type: string
        description: The version of the API used to create the hook and used for hook serialization.
      user:
        $ref: '#/definitions/User'
      aoi:
        type: integer
        description: The pk of the AOI used to filter hook event notifications.
      created:
        type: string
        format: date-time
        description: The date the hook was created.
      target:
        type: string
        description: The destination url callback data is sent to.
      event:
        type: string
        description: The event to be notified for (export.complete, newdata.loaded)
  HookReturn:
    type: object
    properties:
      hooks:
        type: array
        items:
          $ref: '#/definitions/Hook'
        description: A list of hooks.
  HSRS:
    type: integer
    description: The horizontal spatial reference system EPSG code.
  Intensity:
    type: boolean
    description: |
      Whether or not Intensity dimension is included in exported data.
  Length:
    type: number
    format: float
    description: The length used to generate each file.
  Name:
    type: string
    description: The name of the export.
  Notes:
    type: string
    description: User notes.
  PMFTerrain:
    type: string
    description: The PMF terrain option of the export.
  Pk:
    type: integer
    description: The primary key of the object.
  PointcloudDatasetSimple:
    type: object
    description: |
      The simplified point cloud product object lacks the geometry. Geometries are only returned when point cloud products are queried via the 
      `/products/{pk}` endpoint.
    properties:
      datatype:
        $ref: '#/definitions/Datatype'
      name:
        $ref: '#/definitions/Name'
      pk:
        $ref: '#/definitions/Pk'
      sensor:
        $ref: '#/definitions/Sensor'
      collected_at:
        $ref: '#/definitions/CollectedAt'
      classification:
        $ref: '#/definitions/SecurityClassification'
      area:
        $ref: '#/definitions/Area'
      filesize:
        $ref: '#/definitions/Filesize'
      point_count:
        type: integer
        description: The total number of points in the product.
      density:
        type: number
        format: float
        description: The average point density of the product in sq meters.
      aoi_coverage:
        $ref: '#/definitions/AOICoverage'
  PointcloudProduct:
    type: object
    properties:
      datatype:
        $ref: '#/definitions/Datatype'
      name:
        $ref: '#/definitions/Name'
      pk:
        $ref: '#/definitions/Pk'
      sensor:
        $ref: '#/definitions/Sensor'
      collected_at:
        $ref: '#/definitions/CollectedAt'
      classification:
        $ref: '#/definitions/SecurityClassification'
      area:
        $ref: '#/definitions/Area'
      filesize:
        $ref: '#/definitions/Filesize'
      point_count:
        type: integer
        description: The total number of points in the product.
      density:
        type: number
        format: float
        description: The average point density of the product in sq meters.
      geom:
        $ref: '#/definitions/Geometry'
  PointcloudProductSimple:
    type: object
    properties:
      datatype:
        $ref: '#/definitions/Datatype'
      name:
        $ref: '#/definitions/Name'
      pk:
        $ref: '#/definitions/Pk'
      sensor:
        $ref: '#/definitions/Sensor'
      collected_at:
        $ref: '#/definitions/CollectedAt'
      classification:
        $ref: '#/definitions/SecurityClassification'
      area:
        $ref: '#/definitions/Area'
      filesize:
        $ref: '#/definitions/Filesize'
      point_count:
        type: integer
        description: The total number of points in the product.
      density:
        type: number
        format: float
        description: The average point density of the product in sq meters.
  Product:
    type: object
    properties:
      datatype:
        $ref: '#/definitions/Datatype'
      name:
        $ref: '#/definitions/Name'
      pk:
        $ref: '#/definitions/Pk'
      sensor:
        $ref: '#/definitions/Sensor'
      collected_at:
        $ref: '#/definitions/CollectedAt'
      classification:
        $ref: '#/definitions/SecurityClassification'
      area:
        $ref: '#/definitions/Area'
      filesize:
        $ref: '#/definitions/Filesize'
      point_count:
        type: integer
        description: The total number of points in the product.
      density:
        type: number
        format: float
        description: The average point density of the product in sq meters.
      geom:
        $ref: '#/definitions/Geometry'
  ProductReturn:
    type: object
    properties:
      pointclouds:
        type: array
        items:
          $ref: '#/definitions/PointcloudProduct'
        description: A list of pointcloud products.
      rasters:
        type: array
        items:
          $ref: '#/definitions/RasterProduct'
        description: A list of raster products.
      vectors:
        type: array
        items:
          $ref: '#/definitions/VectorProduct'
        description: A list of vector products.
  ProductReturnSimple:
    type: object
    properties:
      pointclouds:
        type: array
        items:
          $ref: '#/definitions/PointcloudProductSimple'
        description: A list of pointcloud products without a geometry.
      rasters:
        type: array
        items:
          $ref: '#/definitions/RasterProductSimple'
        description: A list of raster products without a geometry.
      vectors:
        type: array
        items:
          $ref: '#/definitions/VectorProductSimple'
        description: A list of vector products without a geometry.
  RasterProduct:
    type: object
    properties:
      datatype:
        $ref: '#/definitions/Datatype'
      name:
        $ref: '#/definitions/Name'
      pk:
        $ref: '#/definitions/Pk'
      sensor:
        $ref: '#/definitions/Sensor'
      collected_at:
        $ref: '#/definitions/CollectedAt'
      classification:
        $ref: '#/definitions/SecurityClassification'
      area:
        $ref: '#/definitions/Area'
      filesize:
        $ref: '#/definitions/Filesize'
      geom:
        $ref: '#/definitions/Geometry'
  RasterProductSimple:
    type: object
    description: |
      The simplified raster product object lacks the geometry. Geometries are only returned when raster products are queried via the 
      `/products/{pk}` endpoint.
    properties:
      datatype:
        $ref: '#/definitions/Datatype'
      name:
        $ref: '#/definitions/Name'
      pk:
        $ref: '#/definitions/Pk'
      sensor:
        $ref: '#/definitions/Sensor'
      collected_at:
        $ref: '#/definitions/CollectedAt'
      classification:
        $ref: '#/definitions/SecurityClassification'
      area:
        $ref: '#/definitions/Area'
      filesize:
        $ref: '#/definitions/Filesize'
  RasterDatasetSimple:
    type: object
    description: |
      The simplified raster product object lacks the geometry. Geometries are only returned when raster products are queried via the 
      `/products/{pk}` endpoint.
    properties:
      datatype:
        $ref: '#/definitions/Datatype'
      name:
        $ref: '#/definitions/Name'
      pk:
        $ref: '#/definitions/Pk'
      sensor:
        $ref: '#/definitions/Sensor'
      collected_at:
        $ref: '#/definitions/CollectedAt'
      classification:
        $ref: '#/definitions/SecurityClassification'
      area:
        $ref: '#/definitions/Area'
      filesize:
        $ref: '#/definitions/Filesize'
      aoi_coverage:
        $ref: '#/definitions/AOICoverage'
  RGB:
    type: boolean
    description: Whether or not RGB dimension is included in exported data.
  SecurityClassification:
    type: string
    description: The security classification.
  SendEmail:
    type: boolean
    description: Whether or not to send an email notification upon completion.
  Sensor:
    type: string
    description: The sensor used to make the collection.
  SMRFTerrain:
    type: string
    description: The SMRF terrain option of the export.
  SRIHRES:
    type: number
    format: float
    description: The sri_hres value of the export.
  StartedAt:
    type: string
    format: date-time
    description: Time of creation for the AOI. ISO 8601 format as UTC.
  Status:
    type: string
    description: The status of the export (SUCCESS, RUNNING, QUEUED, CANCELED, and FAILURE).
  Task:
    type: object
    properties:
      state:
        type: string
        description: The state of the task (SUCCESS, RUNNING, QUEUED, CANCELED, and FAILURE).
      time_stamp:
        type: string
        format: date-time
        description: ISO 8601 format as UTC.
      name:
        type: string
        description: The name of the task (export.tasks.generate_export, export.tasks.entwine_export, api.tasks.deliver_hook, tda.tasks.generate_tda, export.tasks.colorize_export_pdf).
      task_id:
        type: string
        description: The ID of the task.
  TaskReturn:
    properties:
      tasks:
        type: array
        items:
          $ref: '#/definitions/Task'
        description: A list of tasks.
  TaskID:
    type: string
    description: The ID of the associated task used for generation.
  Tool:
    type: object
    properties:
      created_at:
        $ref: '#/definitions/CreatedAt'
      name:
        $ref: '#/definitions/Name'
      notes:
        $ref: '#/definitions/Notes'
      pk:
        $ref: '#/definitions/Pk'
      status:
        $ref: '#/definitions/Status'
      type:
        type: string
        description: The tool type (HLZ, LOS, FETE, SLOPE).
      url:
        $ref: '#/definitions/URL'
      task_id:
        $ref: '#/definitions/TaskID'
  ToolsReturn:
    type: array
    items:
      $ref: '#/definitions/Tool'
    description: The tool set of the export.
  URL:
    type: string
    description: The download URL of the export.
  User:
    type: string
    description: The email address of the user that created the object.
  VectorDatasetSimple:
    type: object
    description: |
      The simplified vector product object lacks the geometry. Geometries are only returned when vector products are queried via the 
      `/products/{pk}` endpoint.
    properties:
      datatype:
        $ref: '#/definitions/Datatype'
      name:
        $ref: '#/definitions/Name'
      pk:
        $ref: '#/definitions/Pk'
      collected_at:
        $ref: '#/definitions/CollectedAt'
      classification:
        $ref: '#/definitions/SecurityClassification'
      area:
        $ref: '#/definitions/Area'
      filesize:
        $ref: '#/definitions/Filesize'
      aoi_coverage:
        $ref: '#/definitions/AOICoverage'
  VectorFormat:
    type: string
    description: The format of the output vector file(s).
  VectorProduct:
    type: object
    properties:
      datatype:
        $ref: '#/definitions/Datatype'
      name:
        $ref: '#/definitions/Name'
      pk:
        $ref: '#/definitions/Pk'
      collected_at:
        $ref: '#/definitions/CollectedAt'
      classification:
        $ref: '#/definitions/SecurityClassification'
      area:
        $ref: '#/definitions/Area'
      filesize:
        $ref: '#/definitions/Filesize'
      geom:
        $ref: '#/definitions/Geometry'
  VectorProductSimple:
    type: object
    description: |
      The simplified vector product object lacks the geometry. Geometries are only returned when vector products are queried via the 
      `/products/{pk}` endpoint.
    properties:
      datatype:
        $ref: '#/definitions/Datatype'
      name:
        $ref: '#/definitions/Name'
      pk:
        $ref: '#/definitions/Pk'
      collected_at:
        $ref: '#/definitions/CollectedAt'
      classification:
        $ref: '#/definitions/SecurityClassification'
      area:
        $ref: '#/definitions/Area'
      filesize:
        $ref: '#/definitions/Filesize'
  VSRS:
    type: integer
    description: The vertical spatial reference system EPSG code.
